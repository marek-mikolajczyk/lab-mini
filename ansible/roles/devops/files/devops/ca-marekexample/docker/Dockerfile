FROM alpine:latest

RUN apk update; apk add --no-cache openssl easy-rsa bash apache2
RUN rm -f /var/www/localhost/htdocs/index.html
RUN mkdir /var/www/localhost/htdocs/{CA,server,scripts}
RUN cat << EOF > /var/www/localhost/htdocs/CA/ca-marekexample.crt
-----BEGIN CERTIFICATE-----
MIIDnTCCAoWgAwIBAgIUe7bdNnCcRLc56vuRJa+7LBikt6wwDQYJKoZIhvcNAQEL
BQAwXjELMAkGA1UEBhMCUEwxCzAJBgNVBAgMAlNMMQwwCgYDVQQHDANLQ0UxFTAT
BgNVBAoMDE1BUkVLRVhBTVBMRTEdMBsGA1UEAwwUUm9vdCBDQSBNQVJFS0VYQU1Q
TEUwHhcNMjIwNzAxMDgwMDA2WhcNMzIwNjMwMDgwMDA2WjBeMQswCQYDVQQGEwJQ
TDELMAkGA1UECAwCU0wxDDAKBgNVBAcMA0tDRTEVMBMGA1UECgwMTUFSRUtFWEFN
UExFMR0wGwYDVQQDDBRSb290IENBIE1BUkVLRVhBTVBMRTCCASIwDQYJKoZIhvcN
AQEBBQADggEPADCCAQoCggEBAM7lS22sBYcm4jQ6oLPG0/aXcP8YuvkD0t0WD6BT
5lnRtQiEbX03vJg1TRGxc16nEWamBPcACibYLgJF1vMs+fw1pHUpaIIHdDQzNnW9
7CLkwBdekFS0CQhsnir41Q6LgkpSATMIS7qLGDECNtxBaxEV37ptrQWTsGfzGLI0
oU+K4jVKFLyD5pc9Rq405/Bsg1+OX9r6rYXJLJbRKRul4YKtkOvi9BZMmt4By5qP
liLRUFHsuS8lJ5Dr+7xME3ju8U36DIyoHXraCHwSevURAk6hXA5WmEL2ENTxNuE/
StwhIzodSZG4bJ2l/SK0bUqkcT/diggD7LW/bPl5D0gkJ0MCAwEAAaNTMFEwHQYD
VR0OBBYEFL9Dxc23cwylPAdwjoJW7+4tz2sTMB8GA1UdIwQYMBaAFL9Dxc23cwyl
PAdwjoJW7+4tz2sTMA8GA1UdEwEB/wQFMAMBAf8wDQYJKoZIhvcNAQELBQADggEB
ALNGjOfRXPeUD8+6QCbeCGYBrtmrAGFYLgBWpsvBCG3XAPvQNp+wjLIehkq+3aBS
p7aT29vrkztvMo/YEnuZuCOSjWeqFhCh3opEW8eYwkKtQa+p5LeIj9V+omPSj9Nr
YDBy2XDHLDGtN8tyCJTbo54dxFMFDOA6Lhddh+2XlsZe7Vy/b+HhUGFxyrUrIKlV
5wvd3bujohWvg4XQLAzVSOvDRYmZAtxqZU6FDFSpwnw7l7koORjHfTGNww0vH0ZP
MYtijzOr6tNn1pAN1q1GM2uJ7GYdwdGYdV8U47Ybo0Zglovym+s/B5CwKo7BRfv5
L3/ZXrIsBBQpjvE5jRi5WBY=
-----END CERTIFICATE-----
EOF
RUN cat << EOF > /var/www/localhost/htdocs/CA/ca-marekexample.key
-----BEGIN RSA PRIVATE KEY-----
MIIEpAIBAAKCAQEAzuVLbawFhybiNDqgs8bT9pdw/xi6+QPS3RYPoFPmWdG1CIRt
fTe8mDVNEbFzXqcRZqYE9wAKJtguAkXW8yz5/DWkdSloggd0NDM2db3sIuTAF16Q
VLQJCGyeKvjVDouCSlIBMwhLuosYMQI23EFrERXfum2tBZOwZ/MYsjShT4riNUoU
vIPmlz1GrjTn8GyDX45f2vqthcksltEpG6Xhgq2Q6+L0Fkya3gHLmo+WItFQUey5
LyUnkOv7vEwTeO7xTfoMjKgdetoIfBJ69RECTqFcDlaYQvYQ1PE24T9K3CEjOh1J
kbhsnaX9IrRtSqRxP92KCAPstb9s+XkPSCQnQwIDAQABAoIBAGLwK73qgUo8QfgQ
AUF3V22YxiR3QxJJzdCD+D0HYiSZsCS+j01OFhYDhzNq1GzzH9MimUU086XXw0i6
9Suc2n7NeDO+9YcY4W0FAIoVpJKbKXEDe6nF3nv01T5feCNYe5nm1UP+N5ihY5Qs
Juf1MKoe97pDMHZ2RemvyqONn4ZVW3M607PuzUeuoPNR2ZOWLoKhelybWfMM/qcH
Py6ouo3WsdABr8KNH36PnY1I6TD72NEn9pLuI6g4HxOeGNuMxYs5fh0cJNTAlpsv
+CVX7gD66XkW5M+jL5QF0lNQqwqhdRgneKBxPsqnPHdM8nJ/WHbAhov/DbEf7tgi
OMECTmECgYEA9iYkeZzLa4ohOhWdDgEI7CyCTr70fdn5nCKfWsXr2Io7nBTP9u3w
538zkW6f8wPw5pD7PSYD8jgfquRQvQUmfeNeAbkHprCgcgWNaGFa4sMw0X/8w7DN
TkUC1RZYHEPGWqKzpv9J27f878ULh5PMaEXhUisAc6xfukqevp05Wt8CgYEA1yz+
A49Qb+OdTU6hFzg4m3kZnk8ctdfdJIgkjhUZNEZtc0Qcbv3XnbXKb6bFE1cI2ULy
RVk9g/lC7YRkch0V+iGGoUTKbyMNvp77UymeX+ejS+Mzt5GJ1y+Y2vAo1llB2wn+
0VQ8+SkM0BTiKQ9HCWqzvKVS/L5fuxzCU0FSpB0CgYBzueMUOh95Y+vTPy4j02C6
iQKKu0R/lue//JcnOj50BCmabD6KPbwxWqCIE5anzoaIIEm+qgzY6IIa+lTrSWyb
azZbYP6z4/7LHMkq9fqg+lwNYzsXVhxwXAnE3Uh3oXW0TyJftU6oOox0vhN5nodP
zursksMXn0cycrrHq2u3yQKBgQCyfrs0fsUuG/XYNFrDZTroFdwfi+b4HdpvvJP+
XRgsWiPfE2g21lHvnOcSGZiwA2nuuG87Ad1axgIz/7hHRUN+3CLPUr5O1RhIwZ8g
jIy5Z/D5Ob8kDxH2NKCrNb/al+5eYntEcImn8tqTHk/B2c+Gy0HQQqCF0vKcyC2X
XL/OLQKBgQDAizlLeYHj35e4shOA8jxI6+aYf0p9+B/rn4EQA75vKr51r9ggeyVv
+cTLuBks15X608Whc+1YXf6EO7wQiq9KJXWPltZ9yunH6booPjTXE7Ncorg8uU29
5jHox28rWKG0K74rAumS7EC9srcI1YyDfNcDZbxBtnAjefk91Wq/JQ==
-----END RSA PRIVATE KEY-----
EOF
RUN ln -s /files-marekexample /var/www/localhost/htdocs/files-marekexample
EXPOSE 80
CMD ["/usr/sbin/httpd","-D","FOREGROUND"]
#CMD ln -s /usr/share/easy-rsa /easy-rsa
#CMD /usr/share/easy-rsa/easyrsa init-pki
#CMD /usr/share/easy-rsa/easyrsa build-ca nopass
